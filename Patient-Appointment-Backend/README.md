# Patient Appointment Network Data Application

## Introduction

You have been tasked with building a new CRUD backend for an MVP tool called the Patient Appointment Network
Data Application (PANDA). The PANDA tracks patient demographic data and associated appointments for each patient.

This tool is being built at pace to replace an ageing system which has been vulnerable to several
recent critical CVEs. The client has decided that getting a working replacement into production is a high
priority, and that extra functionality can be iterated upon after the solution is live.

## Application Requirements

The client has elucidated the following hard requirements for the MVP:

 - It should be possible to add patients to and remove them from the PANDA.
 - It should be possible to check and update patient details in the PANDA.
 - It should be possible to add new appointments to the PANDA, and check and update appointment details.
 - The PANDA may need to be restarted for maintenance, and the data should be persisted.
 - The PANDA backend should communicate with the frontend via some sort of HTTP API.
 - The PANDA API should handle authentication, but will be used only by trusted personnel and does not need
   to consider different access levels.
 - Appointments can be cancelled, but cancelled appointments cannot be reinstated.
 - Appointments should be considered 'missed' if they are not set to 'attended' by the end of the appointment.
 - Ensure that all [NHS numbers are checksum validated](https://www.datadictionary.nhs.uk/attributes/nhs_number.html).
 - Ensure that all [postcodes can be coerced into the correct format](https://ideal-postcodes.co.uk/guides/uk-postcode-format).
 - Errors should be reported to the user.

## Backend Requirements

A separate team has been tasked with building the frontend for the application. You've spoken with this team to iron
out the separation of responsibilities:

 - They're quite flexible about what they can build, and willing to defer to your choices about implementation.
 - They're flexible about how they interact with the API, as long as you can provide guidance and they can get data in
   JSON format.
 - Due to time constraints, they will not be able to properly validate the inbound data in the frontend, but can
   propagate error responses returned by the backend.
 - All timestamp passed between the backend and frontend need to be timezone-aware.

It falls to you to build something they can work with. At a minimum they need to be able to create the following views:

### Patients

Patient views must contain the patient's:

 - NHS number
 - Name
 - Date of birth
 - Postcode

### Appointments

Appointment views must contain:

 - The status of the appointment (active, cancelled, attended, or missed)
 - The time of the appointment
 - The duration of the appointment
 - The clinician the appointment will be with
 - The department the appointment will be with
 - The postcode of the appointment's location

## Additional Considerations

As you've worked with the client for a while, you have an awareness of some past issues and upcoming work
that it might be worth taking into consideration:

 - The client has been burned by vendor lock-in in the past, and prefers working with smaller frameworks.
 - The client highly values automated tests, particularly those which ensure their business logic is implemented
   correctly.
 - The client is in negotiation with several database vendors, and is interested in being database-agnostic
   if possible.
 - The client is somewhat concerned that missed appointments waste significant amounts of clinicians' time,
   and is interested in tracking the impact this has over time on a per-clinician and per-department basis.
 - The PANDA currently doesn't contain much data about clinicians, but will eventually track data about the
   specific organisations they currently work for and where they work from.
 - The throughput of the previous application was a bottleneck, and high concurrency is likely to be a
   future optimisation target.
 - The client is interested in branching out into foreign markets, it would be useful if error messages
   could be localised.
 - The client would like to ensure that [patient names can be represented correctly, in line with GDPR](https://shkspr.mobi/blog/2021/10/ebcdic-is-incompatible-with-gdpr/).

## The Test

This test is made up of the following activities, with the last two being the most important
(as your API can't be made live, otherwise).

 - Write a backend for the PANDA which takes into account the above details.
 - Document how to get the API running (this includes e.g. the creation of test users)
 - Document how to interact with the API (this could be instructions on how to access autogenerated
   information).

The above should be provided as a link to a public git repository, or a zipped clone of the git repo.

As the goal of this task is to get a working replacement live, it is up to you to prioritise the
key functionality that should be implemented. We do not expect you to implement all the functionality.
You should timebox this exercise to a few hours.

Feel free to include any extra commentary on choices you have made or difficulties you encountered.
